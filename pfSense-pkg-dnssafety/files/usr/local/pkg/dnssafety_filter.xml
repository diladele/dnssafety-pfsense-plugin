<?xml version="1.0" encoding="utf-8" ?>
<!DOCTYPE packagegui SYSTEM "../schema/packages.dtd">
<?xml-stylesheet type="text/xsl" href="../xsl/package.xsl"?>
<packagegui>
	<copyright>
<![CDATA[
/*
 * dnssafety_filter.xml
 *
 * Copyright (c) 2019 Diladele B.V.
 * All rights reserved.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */
	]]>
	</copyright>
	<name>dnssafety_filter</name>
	<title>DNS Safety</title>
	<include_file>/usr/local/pkg/dnssafety.inc</include_file>
	<tabs>
		<tab>
			<text>Settings</text>
			<url>/pkg_edit.php?xml=dnssafety.xml</url>						
		</tab>
		<tab>
			<text>Forwarders</text>
			<url>/pkg_edit.php?xml=dnssafety_forwarders.xml</url>			
		</tab>
		<tab>
			<text>Cache</text>
			<url>/pkg_edit.php?xml=dnssafety_cache.xml</url>			
		</tab>
		<tab>
			<text>Filtering Policies</text>
			<url>/pkg.php?xml=dnssafety_filter.xml</url>	
			<active/>		
		</tab>
		<tab>
			<text>Custom Domains</text>
			<url>/pkg.php?xml=dnssafety_recategorized.xml</url>			
		</tab>
		<tab>
			<text>Sync</text>
			<url>/pkg_edit.php?xml=dnssafety_sync.xml</url>			
		</tab>
	</tabs>
	<adddeleteeditpagefields>
		<columnitem>
			<fielddescr>Enabled</fielddescr>
			<fieldname>enable</fieldname>
		</columnitem>
		<columnitem>
			<fielddescr>Policy Name</fielddescr>
			<fieldname>name</fieldname>
		</columnitem>
		<columnitem>
			<fielddescr>Policy Description</fielddescr>
			<fieldname>comment</fieldname>
		</columnitem>
		<movable>on</movable>
	</adddeleteeditpagefields>
	<fields>
		<field>
			<fielddescr>Policy Name</fielddescr>
			<fieldname>name</fieldname>
			<description>Enter the name of the policy.</description>
			<type>input</type>
			<required/>
		</field>
		<field>
			<fielddescr>Description</fielddescr>
			<fieldname>comment</fieldname>
			<description>Enter a description of the policy.</description>
			<type>input</type>
		</field>
		<field>
			<fielddescr>Enable</fielddescr>
			<fieldname>enable</fieldname>
			<description>
				<![CDATA[
				Enable policy. If disabled the policy is only stored in the pfSense UI and is not activated in the DNS Safety daemon.
				]]></description>
			<type>checkbox</type>			
		</field>
		<field>
			<type>listtopic</type>
			<name>Policy Members</name>
			<fieldname>members</fieldname>
		</field>
		<field>
			<fielddescr>Names</fielddescr>
			<fieldname>member_names</fieldname>
			<description>List of names, one name per line. For example, user1.</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<fielddescr>MAC Addresses</fielddescr>
			<fieldname>member_macs</fieldname>
			<description>List of MAC addresses, one address per line. For example, 00:50:56:C0:00:01.</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<fielddescr>IPv4 Subnets</fielddescr>
			<fieldname>member_ipv4subnets</fieldname>
			<description>List of IPv4 subnets, one subnet per line. For example, 192.168.1.0/24.</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<fielddescr>IPv4 Ranges</fielddescr>
			<fieldname>member_ipv4ranges</fieldname>
			<description>List of IPv4 ranges, one range per line. For example, 192.168.1.1-192.168.1.100</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<fielddescr>IPv4 Addresses</fielddescr>
			<fieldname>member_ipv4addrs</fieldname>
			<description>List of IPv4 addresses, one address per line. For example, 192.168.1.100.</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<fielddescr>IPv6 Subnets</fielddescr>
			<fieldname>member_ipv6subnets</fieldname>
			<description>List of IPv6 subnets, one subnet per line.</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<fielddescr>IPv6 Ranges</fielddescr>
			<fieldname>member_ipv6ranges</fieldname>
			<description>List of IPv6 ranges, one range per line.</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<fielddescr>IPv6 Addresses</fielddescr>
			<fieldname>member_ipv6addrs</fieldname>
			<description>List of IPv6 addresses, one address per line.</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<type>listtopic</type>
			<name>Filtering Rules / Block Sites by Category</name>
			<fieldname>temp</fieldname>
		</field>
		<field>
			<fielddescr>Enable</fielddescr>
			<fieldname>rules_enable</fieldname>
			<description>
				<![CDATA[
				Apply all filtering rules. If disabled, no filtering rules are applied and the policy in-fact acts as 'allow all' policy. Default value is 'Enable'.
				]]></description>
			<type>checkbox</type>			
		</field>
		<field>
			<fielddescr>Categories</fielddescr>
			<fieldname>rules_categories</fieldname>
			<description>
				<![CDATA[
				Checkbox Control is Wrong. Need to use something like groups in User Manager in pfSense.
				]]></description>
			<type>checkbox</type>			
		</field>
		<field>
			<fielddescr></fielddescr>
			<fieldname>category_advertising</fieldname>			
			<type>select</type>
			<options>
				<option><name>Block Category Advertising</name><value>block</value></option>
				<option><name>Allow Category Advertising</name><value>allow</value></option>
			</options>
		</field>
		<field>
			<fielddescr></fielddescr>
			<fieldname>category_adult_themes_sexuality</fieldname>			
			<type>select</type>
			<options>
				<option><name>Block Category Adult Themes / Sexuality</name><value>block</value></option>
				<option><name>Allow Category Adult Themes / Sexuality</name><value>allow</value></option>
			</options>
		</field>
		<field>
			<fielddescr></fielddescr>
			<fieldname>category_alcohol_tobacco</fieldname>			
			<type>select</type>
			<options>
				<option><name>Block Category Alcohol / Tobacco</name><value>block</value></option>
				<option><name>Allow Category Alcohol / Tobacco</name><value>allow</value></option>
			</options>
		</field>
		<field>
			<fielddescr></fielddescr>
			<fieldname>category_anime_manga_webcomic</fieldname>			
			<type>select</type>
			<options>
				<option><name>Allow Category Anime / Manga / Web Comics</name><value>allow</value></option>
				<option><name>Block Category Anime / Manga / Web Comics</name><value>block</value></option>
			</options>
		</field>
		<field>
			<fielddescr></fielddescr>
			<fieldname>category_arts_society_culture</fieldname>			
			<type>select</type>
			<options>
				<option><name>Allow Category arts_society_culture</name><value>allow</value></option>
				<option><name>Block Category arts_society_culture</name><value>block</value></option>
			</options>
		</field>
		<field>
			<fielddescr></fielddescr>
			<fieldname>category_automotive</fieldname>			
			<type>select</type>
			<options>
				<option><name>Allow Category automotive</name><value>allow</value></option>
				<option><name>Block Category automotive</name><value>block</value></option>
			</options>
		</field>
		<field>
			<fielddescr></fielddescr>
			<fieldname>category_banking_insurance_finance</fieldname>			
			<type>select</type>
			<options>
				<option><name>Allow Category banking_insurance_finance</name><value>allow</value></option>
				<option><name>Block Category banking_insurance_finance</name><value>block</value></option>
			</options>
		</field>
		<field>
			<fielddescr></fielddescr>
			<fieldname>category_blogs_personal</fieldname>			
			<type>select</type>
			<options>
				<option><name>Allow Category blogs_personal</name><value>allow</value></option>
				<option><name>Block Category blogs_personal</name><value>block</value></option>
			</options>
		</field>
		<field>
			<fielddescr></fielddescr>
			<fieldname>category_business_services_industry</fieldname>			
			<type>select</type>
			<options>
				<option><name>Allow Category business_services_industry</name><value>allow</value></option>
				<option><name>Block Category business_services_industry</name><value>block</value></option>
			</options>
		</field>
		<field>
			<fielddescr>temp</fielddescr>
			<fieldname>category_temp</fieldname>
			<description>
				<![CDATA[				
                "classifieds_auctions",
                "content_delivery_networks",
                "cracks_hacking_illegal",
                "dating",
                "drugs",
                "ecommerce_shopping",
                "education_science_research",
                "entertainment_humor_hobby",
                "expired_parked",
                "fashion_beauty_cosmetics",            
                "file_storage",            
                "food_dining_restaurants",
                "forums_message_boards",
                "gambling",
                "games",            
                "generic_non_categorized",
                "government",
                "hate_discrimination_violence",
                "health_medicine_fitness",
                "jobs_employment_career",
                "messaging_chat",            
                "movies",
                "music_radio",
                "network_infrastructure",
                "news_media",
                "nudity_pornography",
                "p2p_file_sharing",
                "photo_sharing",            
                "politics",
                "portals",
                "proxy_anonymizer",
                "real_estate_home_interior",
                "religious",            
                "search_engines",            
                "self_harm"            
                "social_networking",
                "software_technology_hardware",
                "sports",
                "television",
                "travel",            
                "user_tracking",
                "video_sharing",
                "weapons",
                "webmail"
				]]>
			</description>
			<type>select</type>
			<options>
				<option><name>Block</name><value>block</value></option>
				<option><name>Allow</name><value>allow</value></option>
			</options>
		</field>
		<field>
			<type>listtopic</type>
			<name>Filtering Rules / Domain Black Listing</name>
			<fieldname>temp</fieldname>
		</field>
		<field>
			<fielddescr>Domain Name Blacklist</fielddescr>
			<fieldname>rules_blacklist_domain_names</fieldname>
			<description>List of domain names that shall always be blocked in this filtering policy, one name per line. For example, example.com or .example.com. The first blocks exact domain name and the second blocks a domain name with all its sub-domains.</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<fielddescr>Domain Regex Blacklist</fielddescr>
			<fieldname>rules_blacklist_domain_regex</fieldname>
			<description>List of regular expression for domain names that shall always be blocked in this filtering policy, one regular expression per line. For example, regular expression .*\.example\.com blocks all sub-domains of example.com domain.</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<type>listtopic</type>
			<name>Filtering Rules / Domain White Listing</name>
			<fieldname>temp</fieldname>
		</field>
		<field>
			<fielddescr>Domain Names</fielddescr>
			<fieldname>exclusions_domain_names</fieldname>
			<description>List of domain names that shall never be blocked in this filtering policy, one name per line. For example, example.com or .example.com. The first matches exact domain name and the second domain name with all its sub-domains.</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>
		<field>
			<fielddescr>Domain Regex</fielddescr>
			<fieldname>exclusions_domain_regex</fieldname>
			<description>List of regular expression for domain names that shall never be blocked in this filtering policy, one regular expression per line. For example, regular expression .*\.example\.com matches all sub-domains of example.com domain.</description>
			<type>textarea</type>
			<cols>80</cols>
			<rows>4</rows>
			<encoding>base64</encoding>
		</field>				
		<field>
			<type>listtopic</type>
			<name>Custom Views</name>
			<fieldname>temp</fieldname>
		</field>
		<field>
			<fielddescr>Recursion</fielddescr>
			<fieldname>recursion</fieldname>
			<description>
				<![CDATA[
				A recursive query occurs when your DNS server is queried for a domain that it currently knows nothing about,&nbsp;
				in which case it will try to resolve the given host by performing further queries&nbsp;
				(e.g. by starting at the root servers and working out, or by simply passing the request to yet another DNS server).
				]]>
			</description>
			<type>select</type>
			<options>
				<option><name>No</name><value>no</value></option>
				<option><name>Yes</name><value>yes</value></option>
			</options>
		</field>
		<field>
			<fielddescr>match-clients</fielddescr>
			<fieldname>match-clients</fieldname>
			<description>
				<![CDATA[
				If either or both of match-clients are missing they default to any (all hosts match).<br />
				The match-clients statement defines the address_match_list for the source IP address of the incoming messages.
				]]>
			</description>
			<type>select_source</type>
			<source><![CDATA[$config['installedpackages']['bindacls']['config']]]></source>
			<source_name>name</source_name>
			<source_value>name</source_value>
			<multiple/>
			<size>03</size>
		</field>
		<field>
			<fielddescr>allow-recursion</fielddescr>
			<fieldname>allow-recursion</fieldname>
			<description>
				<![CDATA[
				For example, if you have one DNS server serving your local network, you may want&nbsp;
				all of your local computers to use your DNS server.
				]]>
			</description>
			<type>select_source</type>
			<source><![CDATA[$config['installedpackages']['bindacls']['config']]]></source>
			<source_name>name</source_name>
			<source_value>name</source_value>
			<multiple/>
			<size>03</size>
		</field>
		
		<field>
			<fielddescr>Custom Options</fielddescr>
			<fieldname>bind_custom_options</fieldname>
			<description>You can put your own custom options here, separated by semi-colons (;).</description>
			<type>textarea</type>
			<cols>65</cols>
			<rows>8</rows>
			<encoding>base64</encoding>
		</field>
	</fields>
	<custom_php_resync_config_command>
		dnssafety_sync();
	</custom_php_resync_config_command>
</packagegui>
